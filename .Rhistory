ts(1,start = c(2007,6),frequency=12)
ts(rep(1,12),start = c(2007,6),frequency=12)
forecast1_1 <- forecast(fit1_1, h=12, xreg=ts(rep(1,12),start = c(2007,6),frequency=12))
fit1_1 <- arimax(train1, order=c(0,1,0), seasonal= list(order=c(1,1,0), period=12), xreg=intervention1)
forecast1_1 <- forecast(fit1_1, h=12, xreg=ts(rep(1,12),start = c(2007,6),frequency=12))
forecast1_1 <- forecast(fit1_1, h=12, xreg=rep(1,12))
accuracy(fit1_1)
fit1_1
checkresiduals(fit1_1)
fit1
fit1_1
intervention1_pred <- data.frame(x1=rep(1,12))
View(intervention1_pred)
View(intervention1)
forecast1_1 <- forecast(fit1_1, h=12, xreg=intervention1_pred)
intervention1 <- c(rep(0,18),rep(1,30))
intervention1_pred <- data.frame(x1=rep(1,12))
fit1_1 <- arimax(train1, order=c(0,1,0), seasonal=list(order=c(1,1,0), period=12), xreg=intervention1)
forecast1_1 <- forecast(fit1_1, h=12, xreg=rep(1,12))
fit1_1
forecast1_1 <- predict(fit1_1, h=12, xreg=rep(1,12))
forecast1_1 <- predict(fit1_1, h=12, xreg=intervention1)
forecast1_1 <- predict(fit1_1, h=12, newxreg=intervention1)
forecast1_1 <- predict(fit1_1, h=12, newxreg=rep(1,12))
ts.plot(cbind(train1, test1, forecast1_1$mean), lty=1:3)
ts.plot(cbind(train1, test1, forecast1_1), lty=1:3)
forecast1_1
fit1_1 <- arimax(train1, order=c(0,1,0), seasonal=list(order=c(1,1,0), period=12), xtransf =intervention1)
forecast1_1 <- predict(fit1_1, h=12, xtransf=rep(1,12))
forecast1_1
fit1_1
forecast1_1 <- forecast(fit1_1, h=12, xtransf=rep(1,12))
auto.arima(train2)
fit2 <- auto.arima(train2)
forecast2 <- forecast(fit2, h=12)
accuracy(forecast2$mean, test2)
ts.plot(cbind(train2, test2, forecast2$mean), lty=1:3)
data <- read.csv('Airline_Delay_Cause.csv')
data[is.na(data)] <- 0
data$date <- as.Date(paste(data$year,'-',data$month,'-','01', sep = ''))
flights <- data %>% group_by(date) %>%
summarise(flights = sum(arr_flights), delays = sum(arr_del15), carrier = sum(carrier_ct),
weather = sum(weather_ct), nas = sum(nas_ct), security = sum(security_ct),
late_aircraft = sum(late_aircraft_ct), late_aircraft = sum(late_aircraft_ct),
cancellation = sum(arr_cancelled), diversions = sum(arr_diverted))
flights = subset(flights, select = -c(date))
flights_ts <- ts(flights, start = c(2003,6), frequency = 12)
total_flights <- flights_ts[,1]
total_delays <- flights_ts[,2]
total_flights_trunc <- ts(flights_ts[1:201,1], start = c(2003,6), frequency = 12)
total_delays_trunc <- ts(flights_ts[1:201,2], start = c(2003,6), frequency = 12)
total_flights
tsdisplay(total_flights)
tsdisplay(total_delays)
tsdisplay(total_flights_trunc)
seq(data)
seq(data)==13
data("airmiles")
data.frame(I911=1*(seq(airmiles)==69),I911=1*(seq(airmiles)==69)
data.frame(I911=1*(seq(airmiles)==69),I911=1*(seq(airmiles)==69))
list(c(0,0),c(1,0))
data.frame(I911=1*(seq(airmiles)==69),I911=1*(seq(airmiles)==69))
Jan97=1*(seq(airmiles)==13),Dec02=1*(seq(airmiles)==84)
data.frame(Dec96=1*(seq(airmiles)==12),Jan97=1*(seq(airmiles)==13),Dec02=1*(seq(airmiles)==84))
accuracy2 <- accuracy(forecast2$mean, test2)
forecast2 <- forecast(fit2, h=12)
auto.arima(train2)
train1 <- ts(flights_ts[1:48,1], start = c(2003,6), frequency = 12)
test1 <- ts(flights_ts[49:60,1], start = c(2007,6), frequency = 12)
train2 <- ts(flights_ts[1:132,1], start = c(2003,6), frequency = 12)
test2 <- ts(flights_ts[133:144,1], start = c(2014,6), frequency = 12)
train3 <- ts(flights_ts[1:132,1], start = c(2003,6), frequency = 12)
test3 <- ts(flights_ts[1:132,1], start = c(2003,6), frequency = 12)
auto.arima(train1)
fit1 <- auto.arima(train1)
forecast1 <- forecast(fit1, h=12)
ts.plot(cbind(train1, test1, ts(forecast1$mean, start = c(2007,6), frequency=12)), lty=1:3)
accuracy(forecast1$mean, test1)
auto.arima(train2)
fit2 <- auto.arima(train2)
forecast2 <- forecast(fit2, h=12)
accuracy2 <- accuracy(forecast2$mean, test2)
ts.plot(cbind(train2, test2, forecast2$mean), lty=1:3)
View(accuracy2)
accuracy2
auto.arima(train1)
fit1 <- auto.arima(train1)
forecast1 <- forecast(fit1, h=12)
accuracy1 <- accuracy(forecast1$mean, test1)
ts.plot(cbind(train1, test1, ts(forecast1$mean, start = c(2007,6), frequency=12)), lty=1:3)
accuracy(forecast1$mean, test1)
auto.arima(train1)
fit1 <- auto.arima(train1)
forecast1 <- forecast(fit1, h=12)
accuracy1 <- accuracy(forecast1$mean, test1)
ts.plot(cbind(train1, test1, ts(forecast1$mean, start = c(2007,6), frequency=12)), lty=1:3, col = c('train','test','forecast'))
auto.arima(train1)
fit1 <- auto.arima(train1)
forecast1 <- forecast(fit1, h=12)
accuracy1 <- accuracy(forecast1$mean, test1)
ts.plot(cbind(train1, test1, ts(forecast1$mean, start = c(2007,6), frequency=12)), lty=1:3)
accuracy(forecast1$mean, test1)
auto.arima(train2)
fit2 <- auto.arima(train2)
forecast2 <- forecast(fit2, h=12)
accuracy2 <- accuracy(forecast2$mean, test2)
accuracy2
ts.plot(cbind(train2, test2, forecast2$mean), lty=1:3)
intervention1 <- data.frame(Jan2005=1*seq(train1)==20)
intervention1 <- data.frame(Jan2005=1*(seq(train1)==20))
View(intervention1)
auto.arima(train2)
fit2 <- auto.arima(train2)
forecast2 <- forecast(fit2, h=12)
accuracy2 <- accuracy(forecast2$mean, test2)
accuracy2
ts.plot(cbind(train2, test2, forecast2$mean), lty=1:3)
intervention2 <- data.frame(c(rep(0,63),rep(1,132-63)))
arimax()
arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2)
View(intervention2)
View(intervention2)
intervention2 <- data.frame(Aug08 = c(rep(0,63),rep(1,132-63)))
arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2)
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2)
accuracy(fit2_1)
fit2_1
summary(fit2_1)
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1), xreg = intervention2)
summary(fit2_1)
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2)
RMSE(fit2_1)
fitted(fit2_1)
points(fitted(fit2_1))
plot(train1)
points(fitted(fit2_1))
points(fitted(fit2))
plot(train1)
points(fitted(fit2))
plot(train1)
points(fitted(fit2))
plot(train1)
points(fitted(fit2_1))
RMSE(fitted(fit2_1),train2)
RMSE(fitted(fit2),train2)
RMSE(fitted(fit2_1),train2)
RMSE(fitted(fit2),train2)
View(flights)
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intevention1,intervention2))
intervention1 <- data.frame(Jan2005=1*(seq(train2)==20))
intervention2 <- data.frame(Aug08 = c(rep(0,63),rep(1,132-63)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intevention1,intervention2))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
RMSE(fitted(fit2_1),train2)
RMSE(fitted(fit2),train2)
fitted(fit2_1)
plot(train2)
points(fitted(fit2_1))
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,63),rep(1,132-63)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
RMSE(fitted(fit2_1),train2)
RMSE(fitted(fit2),train2)
plot(train2)
points(fitted(fit2_1))
intervention1 <- data.frame(Jan2005=1*(seq(train2)==19))
intervention2 <- data.frame(Aug08 = c(rep(0,63),rep(1,132-63)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
RMSE(fitted(fit2_1),train2)
RMSE(fitted(fit2),train2)
plot(train2)
points(fitted(fit2_1))
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,63),rep(1,132-63)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
RMSE(fitted(fit2_1),train2)
RMSE(fitted(fit2),train2)
plot(train2)
points(fitted(fit2_1))
intervention1 <- data.frame(Jan2005=1*(seq(train2)==19))
intervention2 <- data.frame(Aug08 = c(rep(0,63),rep(1,132-63)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
RMSE(fitted(fit2_1),train2)
RMSE(fitted(fit2),train2)
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
forecast(fit2_1, h=12, data.frame(Jan2005=rep(0,12), Aug08=rep(1,12)))
data.frame(Jan2005=rep(0,12), Aug08=rep(1,12)
data.frame(Jan2005=rep(0,12), Aug08=rep(1,12))
data.frame(Jan2005=rep(0,12))
data.frame(Jan2005=rep(0,12), Aug08=rep(1,12))
forecast(fit2_1, h=12, newxreg = data.frame(Jan2005=rep(0,12), Aug08=rep(1,12)))
cbind(intevention1,intervention2)
cbind(intervention1,intervention2)
newxreg = data.frame(Jan2005=rep(0,12), Aug08=rep(1,12))
forecast(fit2_1, h=12, newxreg = newxreg)
forecast(fit2_1, h=12, xreg = newxreg)
predict(fit2_1, h=12, newxreg = newxreg)
intervention1 <- data.frame(Jan2005=1*(seq(train2)==19))
intervention2 <- data.frame(Aug08 = c(rep(0,63),rep(1,132-63)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
intervention1 <- data.frame(Jan2005=1*(seq(train2)==19))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
intervention1 <- data.frame(Jan2005=1*(seq(train2)==19))
intervention2 <- data.frame(Aug08 = c(rep(0,61),rep(1,132-61)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
intervention1 <- data.frame(Jan2005=1*(seq(train2)==19))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
intervention1 <- data.frame(Jan2005=1*(seq(train2)==19))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
fit2_1
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2)
fit2_1
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
auto.arima(train1)
fit1 <- auto.arima(train1, xreg = data.frame(Jan2005=1*(seq(train1)==18)))
fit1 <- auto.arima(train1, xreg = c(1*(seq(train1)==18))))
fit1 <- auto.arima(train1, xreg = c(1*(seq(train1)==18)))
fit1
forecast1 <- forecast(fit1, h=12)
forecast1 <- forecast(fit1, h=12, xreg = c(rep(0,12)))
accuracy1 <- accuracy(forecast1$mean, test1)
accuracy1
ts.plot(cbind(train1, test1, ts(forecast1$mean, start = c(2007,6), frequency=12)), lty=1:3)
auto.arima(train1)
fit1 <- auto.arima(train1)
forecast1 <- forecast(fit1, h=12)
accuracy1 <- accuracy(forecast1$mean, test1)
accuracy1
ts.plot(cbind(train1, test1, ts(forecast1$mean, start = c(2007,6), frequency=12)), lty=1:3)
accuracy(forecast1$mean, test1)
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2, xtransf = intervention1, transfer = c(1,1))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2, xtransf = intervention1, transfer = list(c(1,1)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2, xtransf = intervention1, transfer = list(c(1,1)), method = 'ML)
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2, xtransf = intervention1, transfer = list(c(1,1)), method = 'ML')
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2,
xtransf = intervention1, transfer = c(0,0), method = 'ML')
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1), xreg = intervention2,
xtransf = intervention1, transfer = list(c(1,1)), method = 'ML')
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), method = 'ML')
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), method = 'CSS')
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), method = 'CSS', hessian = FALSE)
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), method = 'CSS')
fit2_1 = arimax(train2, order = c(1,0,2), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = cbind(intervention1,intervention1), transfer = list(c(1,1),c(0,1)))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,0,1)))
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5,0.5))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5,0.5,0.5,0.5,0.5))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5,0.5,0.5,0.5))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5,0.5,0.5))
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5)
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5,0.5))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5,0.5,0.5))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5,0.5,0.5,0.5))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5,0.5,0.5,0.5,0.5))
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)), init = c(0.5,0.5,0.5,0.5,0.5,0.5))
fit2_2 = arima(train2, order = c(1,0,1), seasonal = c(0,1,1),
xreg = intervention1)
fit2_@
plot(train2)
fit2_2
summary(fit2_2)
accuracy(fitted(fit2_2), train2)
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
fit2_1 = arimax(log(train2), order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)))
data(airmiles)
air.m1=arimax(log(airmiles),order=c(0,1,1),
seasonal=list(order=c(0,1,1),period=12),
xtransf=data.frame(I911=1*(seq(airmiles)==69),
I911=1*(seq(airmiles)==69)),transfer=list(c(0,0),c(1,0)),
xreg=data.frame(Dec96=1*(seq(airmiles)==12),
Jan97=1*(seq(airmiles)==13),Dec02=1*(seq(airmiles)==84)),
method='ML')
air.m1
summary(air.m1)
air.m1=arimax(train2,order=c(0,1,1),
seasonal=list(order=c(0,1,1),period=12),
xtransf=data.frame(I105=1*(seq(train2)==18),
I105=1*(seq(train2)==18)),transfer=list(c(0,0),c(1,0)),
xreg=data.frame(Aug08=1*(seq(airmiles)==62)),
method='ML')
air.m1=arimax(train2,order=c(0,1,1),
seasonal=list(order=c(0,1,1),period=12),
xtransf=data.frame(I105=1*(seq(train2)==18),
I105=1*(seq(train2)==18)),transfer=list(c(0,0),c(1,0)),
xreg=data.frame(Aug08=1*(seq(train2)==62)),
method='ML')
air.m1=arimax(train2,order=c(0,1,1),
seasonal=list(order=c(0,1,1),period=12),
xtransf=data.frame(I105=1*(seq(train2)==18),
I105=1*(seq(train2)==18)),transfer=list(c(0,0),c(1,0)),
xreg=data.frame(Aug08=1*(seq(train2)==62)),method="CSS-ML")
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(log(train2), order = c(1,0,1), seasonal = c(0,1,1),
xtransf = intervention1, transfer = list(c(1,1)))
fit2_1 = arimax(log(train2), order = c(1,0,1), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(log(train2), order = c(1,0,1), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
plot(train2)
points(fitted(fit2_1))
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_2), train2)
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
summary(fit2_1)
train1 <- ts(total_delays[1:48,1], start = c(2003,6), frequency = 12)
train1 <- ts(total_delays[1:48], start = c(2003,6), frequency = 12)
test1 <- ts(total_delays[49:60], start = c(2007,6), frequency = 12)
train2 <- ts(total_delays[1:132], start = c(2003,6), frequency = 12)
test2 <- ts(total_delays[133:144], start = c(2014,6), frequency = 12)
train3 <- ts(total_delays[1:180], start = c(2003,6), frequency = 12)
test3 <- ts(total_delays[181:192], start = c(2018,6), frequency = 12)
train4 <- ts(total_delays[1:216], start = c(2003,6), frequency = 12)
test4 <- ts(total_delays[181:228], start = c(2018,6), frequency = 12)
auto.arima(train1)
fit1 <- auto.arima(train1)
forecast1 <- forecast(fit1, h=12)
accuracy1 <- accuracy(forecast1$mean, test1)
accuracy1
ts.plot(cbind(train1, test1, ts(forecast1$mean, start = c(2007,6), frequency=12)), lty=1:3)
accuracy(forecast1$mean, test1)
forecast1 <- forecast(fit1, h=12)
auto.arima(train2)
fit2 <- auto.arima(train2)
forecast2 <- forecast(fit2, h=12)
accuracy2 <- accuracy(forecast2$mean, test2)
accuracy2
ts.plot(cbind(train2, test2, forecast2$mean), lty=1:3)
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
fit2_1 = arimax(log(train2), order = c(1,0,1), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
summary(fit2_1)
plot(train2)
points(fitted(fit2_1))
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_2), train2)
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
fitted(fit2_1)
plot(train2)
points(fitted(fit2_1))
train2
accuracy(fitted(fit2_2), train2)
summary(fit2_1)
fit2_1 = arimax(train2, order = c(1,0,1), seasonal = c(0,1,1), xreg = cbind(intervention1,intervention2))
summary(fit2_1)
plot(train2)
plot(train2)
points(fitted(fit2_1))
fit2_@
fit2_2
fit2_2
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
auto.arima(train2)
fit2_1 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xreg = cbind(intervention1,intervention2))
summary(fit2_1)
plot(train2)
points(fitted(fit2_1))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = intervention1, transfer = list(c(0,0)))
summary(fit2_2)
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = intervention1, transfer = list(c(0,1)))
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = intervention1, transfer = list(c(1,0)))
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = intervention1, transfer = list(c(1,0,1)))
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = intervention1, transfer = list(c(1,0,1)), method = 'ML')
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = intervention1, method = 'ML')
summary(fit2_2)
plot(train2)
points(fitted(fit2_1))
plot(train2)
points(fitted(fit2))
View(flights_ts)
total_flights_trunc
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = cbind(intervention1, transfer = c(1,1))
fit2_2
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = cbind(intervention1, transfer = c(1,1)))
fit2_2
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = intervention1, transfer = c(1,1))
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = cbind(intervention1), transfer = c(1,1))
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = cbind(intervention1), transfer = list(c(1,1)))
plot(train2)
points(fitted(fit2))
plot(train4)
plot(train3)
plot(diff(train3))
plot(train2)
points(fitted(fit2_1))
plot(train2)
points(fitted(fit2))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
auto.arima(train2)
fit2_1 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xreg = cbind(intervention1,intervention2))
fit2_2 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xtransf = cbind(intervention1), transfer = list(c(1,1)))
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
auto.arima(train2)
fit2_1 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xreg = cbind(intervention1,intervention2))
summary(fit2_2)
plot(train2)
points(fitted(fit2_1))
plot(train2)
points(fitted(fit2))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
fit2_2
plot(diff(train3))
plot(BoxCox(diff(train3,lambda='auto'))
plot(BoxCox(diff(train3,lambda='auto')))
plot(boxcox(diff(train3,lambda='auto')))
BoxCox(diff(train3), lambda = 'auto')
plot(BoxCox(diff(train3), lambda = 'auto'))
diff(train3,lambda='auto')
plot(diff(train3))
plot(diff(train3))
plot(BoxCox(diff(train3), lambda = 'auto'))
plot(log(diff(train3)))
intervention1 <- data.frame(Jan2005=1*(seq(train2)==18))
intervention2 <- data.frame(Aug08 = c(rep(0,62),rep(1,132-62)))
auto.arima(train2)
fit2_1 = arimax(train2, order = c(0,1,1), seasonal = c(2,0,0), xreg = cbind(intervention1,intervention2))
summary(fit2_2)
plot(train2)
points(fitted(fit2_1))
plot(train2)
points(fitted(fit2))
accuracy(fitted(fit2_1), train2)
accuracy(fitted(fit2),train2)
